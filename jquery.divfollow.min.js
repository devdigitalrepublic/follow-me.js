/* DivFollow 1.5 | Anthony Drake Frost | http://korobu.com/divfollow */
(function(f){function g(c,e,d,a,b,k){if(null!==a.min&&window.innerWidth<=a.min||null!==a.max&&window.innerWidth>=a.max)return c.css("margin-top",d+"px"),b;var g=e.offset().top,m=g+d,h=c.outerHeight();e=e.height()-h;var l=f(window).scrollTop()+(""===a.offsetElement?a.offset:f("#"+a.offsetElement).height()),h=parseInt(c.css("margin-top"),10);l>m?(d=l-g,d<e?(b[0]||(b[0]=!0,a.movingStart()),k?c.stop().animate({marginTop:d+"px"},a.speed,function(){a.movingEnd();b[0]=!1;b[1]=!1;b[2]=!1}):c.css("margin-top",d+"px")):h!==e&&(b[1]||(b[1]=!0,a.bottomStart()),k?c.stop().animate({marginTop:e+"px"},a.speed,function(){a.bottomEnd();b[0]=!1;b[1]=!1;b[2]=!1}):c.css("margin-top",e+"px"))):h!==d&&(b[2]||(b[2]=!0,a.topStart()),k?c.stop().animate({marginTop:d+"px"},a.speed,function(){a.topEnd();b[0]=!1;b[1]=!1;b[2]=!1}):c.css("margin-top",d+"px"));return b}f.fn.follow=function(c){var e=f.extend({container:"container",topStart:function(){},topEnd:function(){},bottomStart:function(){},bottomEnd:function(){},movingStart:function(){},movingEnd:function(){},speed:500,offset:0,offsetElement:"",min:null,max:null},c);return this.each(function(){var d=f("#"+e.container),a=f(this),b=a.offset().top-d.offset().top,c=[!1,!1,!1],c=g(a,d,b,e,c,!1);f(window).scroll(function(){g(a,d,b,e,c,!0)});f(window).resize(function(){a.css("margin-top");a.css("margin-top","0px");c=g(a,d,b,e,c,!1)})})}})(jQuery);